---
share: true
---

# Linear Assignment Problem

## Ref
- [https://zhuanlan.zhihu.com/p/591631161](https://zhuanlan.zhihu.com/p/591631161)

## Problem Formulation
假设有n个工人和n项任务，某个工人完成某项任务的要价是$C_{ij}$。目标是：
1. 所有任务都要完成。
2. 要价之和要最小。
问在这两个限制条件之下的分配关系应该是什么样的。

$$
\begin{array}{ll}
\min & \sum_{1 \leq i, j \leq N} C_{i j} x_{i j} \\
\text { s.t. } & x_{i j} \in\{0,1\} \\
& \sum_{i=1}^{N} x_{i j}=1, \forall 1 \leq j \leq N \\
& \sum_{j=1}^{N} x_{i j}=1, \forall 1 \leq j \leq N
\end{array}
$$

- 其中$C_{ij}$是要价矩阵的元素。
- $x_{i j} \in {0,1}$表示这是一个二值问题，x只能取0和1。
- 另外两个条件表示任务和工人只能是1对1的关系。
- 之所以是线性分配问题，是因为cost是线性相加的。
- 这个问题可以转化再二分图（Bipartite Graph）的框架下描述，即寻找一个匹配，其边的和最小。


## 问题分类

$\underline{Balanced \ vs. \ Unbalanced \ assignment}$
如果人数和任务数一样，则是balanced assignment。


## Solution

$\underline{方法一}$
- 上面是个混合整数规划问题（Mixed Integer Programming），典型组合优化，爆破需要O(N!)，然而将其松弛（relax）一下，把$x_{ij}$的取值变成0到1之间的实数，原问题被转化成了一个线性规划问题，其可行集是个凸多面体，而每个顶点都是原问题的解，由于目标函数也是线性的，求解这个线性规划问题，某个顶点一定在其解集内，那么可以认为得到的解就是原问题的解。
- 此法复杂度过高，耗时很大。

$\underline{方法二，Hungarian/Munkres算法}$
主要有六大步骤，写得繁琐，其实很简单，算法出口在第3步：

1. 对于每一行，找到最小值，从每一行中减去该最小值，这样每行至少有一个零，这些零的位置代表了让每个大学生都有工作的安排的条件下，最小的消耗。但可能有的工作没人做，后面几个步骤就是不停调整解决这个问题。执行第2步；
2. 逐个遍历矩阵$C$的零元素，如果该零元素的行与列中没有被“标记”的零元素，就将其“标记”。执行第3步；
3. 对于C的每一列，如果有一个“标记”的零元素，则“覆盖”该列。如果所有列都被“覆盖”，就意味着每一列都有一个被“标记”的零元素，也就代表了每一行刚好也有一个被“标记”的零元素，**那么结束了**，得到结果了；否则，执行第4步；
4. 尝试在没被“覆盖”的位置上找到一个零元素，如果没有，保存最小的未被覆盖的零元素，执行第6步；否则，“刻记”该元素，如果该元素所在行没有“标记”元素，执行第5步；如果该元素所在行有“标记”元素，将“标记”元素的列取消“覆盖”，并将此行“覆盖”，重复执行第4步；
5. 这步比较神奇，注意这步是从第4步过来，从该“刻记”元素出发，尝试找到同列的“标记”元素，再找“同行”的“刻记”元素。。。直到某个“刻记”元素找不到下个一个“标记”元素。清除矩阵中的所有“标记”元素，然后将序列中的所有“刻记”元素转化为“标记”元素，清除所有覆盖，执行第3步，（“标记”元素马上又会被覆盖）。
6. 未覆盖区域减去未覆盖区域中最小的元素，执行第4步，注意此时产生了一个未覆盖的零元素；

此方法的复杂是$O(N^3)$。一般针对Balanced assignment。当不平衡时，可以添加dummy variable来使问题转化为平衡问题。

# Quadratic Assignment Problem